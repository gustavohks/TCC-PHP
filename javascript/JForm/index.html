<html>
    <head>
        <title>Form Builder</title>
        <script type="text/javascript" src="test.js"></script>

        <!-- <script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script> -->
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/bootstrap-responsive.min.css" rel="stylesheet">
        <!-- <link href="css/codemirror.css" rel="stylesheet"> -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <link href="css/form_builder.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <script src="js/popper.min.js"></script>
        <script src="js/bootstrap.min.js"></script>
    </head>
    <body>
        <div class="row-fluid" style="overflow: hidden">
            <div class="span10 offset1">
                <div class="row-fluid">
                    <div class="span8">
                        <h1>JForm</h1>
                        <hr>
                        <div class="tabbable">
                            <ul class="nav nav-tabs">
                                <li class="active"><a href="#editor-tab" data-toggle="tab">Editor</a></li>
                                <!-- <li><a href="#source-tab" data-toggle="tab">Source</a></li> -->
                            </ul>

                            <div class="tab-content">
                                <div class="tab-pane active" id="editor-tab">
                                    <div id="content" class="form-horizontal">
                                        <fieldset id="content_form_name">
                                            <legend>Formulário</legend>
                                        </fieldset>
                                        <div class="container"> 
                                                <div class = "row" id="forma"></div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                    <div class="span4" >
                        <h1>Botões</h1>
                        <hr>
                        <div id="components-container" class="pagination-centered">
                            <div class="control-group component" data-type="text">
                                <button id="addTextfield" class="btn btn-primary" style="width: 50%; height: 50px; font-size : 16px;"><i class="fa fa-indent" aria-hidden="true"></i> Add textfield</button>
                            </div>
                            <div class="control-group component">
                                <button id="addPassword" class="btn btn-primary" style="width: 50%; height: 50px; font-size : 16px;"><i class="fa fa-key" aria-hidden="true"></i> Add password</button>

                            </div>
                            <div class="control-group component">
                                <button id="addCheckbox" class="btn btn-primary" style="width: 50%; height: 50px; font-size : 16px;"><i class="fa fa-check-square-o" aria-hidden="true"></i> Add checkbox</button>
                            </div>
                            <div class="control-group component">
                                    <button id="addRadio" class="btn btn-primary" style="width: 50%; height: 50px; font-size : 16px;"><i class="fa fa-circle-o" aria-hidden="true"></i> Add radio</button>
                            </div>
                            <div class="control-group component">
                                    <button id="addSubmit" class="btn btn-primary" style="width: 50%; height: 50px; font-size : 16px;"><i class="fa fa-send-o"></i> Add submit</button>
                            </div>                          
                            <div class="control-group component">
                                    <button id="addReset" class="btn btn-primary" style="width: 50%; height: 50px; font-size : 16px;"><i class="fa fa-refresh"></i> Add reset</button>
                            </div>
                            <div class="form-actions component" data-type="submit">
                                <input class="btn btn-danger"  type="button" value="Refresh Page" onClick="window.location.reload()" style="width: 33%; height: 33px; font-size : 16px;">
                                <input class="btn btn-success"  type="button" value="Save" id="save" style="width: 33%; height: 33px; font-size : 16px;">
                                <input class="btn btn-info"  type="button" value="Copy HTML" id="copyHTML" style="width: 33%; height: 33px; font-size : 16px; margin-top: 10px;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        </div>
      
  <!-- Modal -->
  <div class="modal fade" id="textfieldModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Editar</h4>
        </div>
        <div class="modal-body">
          <p>Label:</p>
          <p> <input type="text" name="fetchLabelTextField" id="fetchLabelTextField" value=""  style="height: 30px; width:300px"></p>          
          <p>Conteúdo:</p>
          <p> <input type="text" name="fetchPlaceholderTextField" id="fetchPlaceholderTextField" value=""  style="height: 30px; width:300px"></p>          
          <p>Name:</p>
          <p> <input type="text" name="fetchNameTextField" id="fetchNameTextField" value=""  style="height: 30px; width:300px"></p>          
          <p>Width:</p>
          <p> <input type="number" name="fetchWidthTextField" id="fetchWidthTextField" value=""  style="height: 30px; width:300px"></p>            
          <p>Div size:</p>
          <p> <input type="text" name="fetchDivTextField" id="fetchDivTextField" value=""  style="height: 30px; width:300px"></p>          
          <p>ID:</p>
          <p> <input type="text" name="fetchIdTextField" id="fetchIdTextField" value=""  style="height: 30px; width:300px"><input type="hidden" id="fetchHidden" value=""/></p>
        </div>
        <div class="modal-footer">
          <button type="button" class="salvar btn btn-success" data-dismiss="modal" name="salvarTextField" id="salvarTextField" value="">Save</button>
          <button type="button" class="fechar btn btn-danger" data-dismiss="modal" value="">Close</button>
        </div>
      </div>
      
    </div>
  </div> 
</div>

<script type="text/javascript">
var KEYCODE_ENTER = 13;
var KEYCODE_ESC = 27;

$(document).keyup(function(e) {
  if (e.keyCode == KEYCODE_ENTER) $('.salvar').click();
  if (e.keyCode == KEYCODE_ESC) $('.fechar').click();
});

$(document).ready(function(){
    $("#copyHTML").click(function(){
        alert($("#forma").html());
    });
});

$(document).ready(function() {
    $('#save').on('click', function() { 
            $('.teste').fadeOut(300, function(){ 
                $(this).remove();
            }); 
   })
    return false;
});


$(document).ready(function() {
    var forma = $('#forma');
    var i = $('#forma').length;
    
   $(document).on('click', '#addTextfield', function(){
            $('<div class="col-12" style="padding: 10px;" id = divTextField' + i +'><label style="font-weight: bold;" id="labelTextField' + i +'">Texto: </label><input type="text" class="textfield' + i +'" id="textfield' + i +'" style = "width: 300px;" name="textfield" value="" placeholder="Digite o seu texto" /> <button id="removeTextfield" class="teste teste btn btn-danger btn-sm" value="' + i + '"><i class="fa fa-close"></i></button> <button data-toggle="modal" data-target="#textfieldModal" name="editTextField" id="editTextField" class="teste btn btn-primary btn-sm" value="' + i + '"  ><i class="fa fa-pencil"></i><input type="hidden" id="hidden' + i + '" value="' + i + '"/></button></div>').appendTo(forma);
            
            i++;
            return false;
    });    
   $(document).on('click', '#removeTextfield', function(){
            if( i > 0 ) {
                //$(this).parent().remove();
                //i--;
                var id = $(this).attr('value');
                $('#divTextField'+id).fadeOut(300, function(){ 
                    $(this).remove();
                });
           }
            return false;
    });

});
    $(document).on('click', '#editTextField', function(){

      // impede que o form envie o post
      event.preventDefault();
      var i = $(this).attr('value');
      // var id = $(this).parent().find("input[type='hidden']").val();
      // var idLabel = $(this).parent().find("input[type='hidden']").val();

      // if (id.match(/^[0-9]+$/) != null) {
      //   id = "textfield" + id;
      //   idLabel = "labelTextField" + idLabel;
      // } else{
      //   id = id;
      //   idLabel = idLabel;
      // }

      // pega os dados de forma individual do form
      // var placeholder = $('#textfield'+id).val();
      var placeholderTextField = $('.textfield'+i).attr('placeholder'); 
      var nameTextField = $('.textfield'+i).attr('name'); 
      var labelTextField = document.getElementById('labelTextField'+i).textContent;
      var widthTextField = $('.textfield'+i).width();
      var idTextField = $('.textfield'+i).attr('id');
      var divTextField = $('#divTextField'+i).attr('class');
      //atribui um valor para o campo com id fetchHidden
      $(fetchHidden).val(i);

      $('#fetchPlaceholderTextField').attr('placeholder',placeholderTextField);

      $(fetchPlaceholderTextField).val(placeholderTextField);
      $('#fetchNameTextField').attr('name',nameTextField);
      $(fetchNameTextField).val(nameTextField);


      $('#fetchLabelTextField').attr('value',labelTextField);
      $(fetchLabelTextField).val(labelTextField);

      $('#fetchWidthTextField').attr('width',widthTextField);
      $(fetchWidthTextField).val(widthTextField);

      $('#fetchIdTextField').attr('name',idTextField);
      $(fetchIdTextField).val(idTextField);

      $('#fetchDivTextField').attr('class',divTextField);
      $(fetchDivTextField).val(divTextField);

      // $('#salvarTextField').attr('value',id);

    });

    $(document).on('click', '#salvarTextField', function(){
      var inputPlaceholderTextField = document.getElementById('fetchPlaceholderTextField');
      var inputLabelTextField = document.getElementById('fetchLabelTextField');
      var inputNameTextField = document.getElementById('fetchNameTextField');
      var inputWidthTextField = document.getElementById('fetchWidthTextField');
      var inputIdTextField = document.getElementById('fetchIdTextField');
      var inputDivTextField = document.getElementById('fetchDivTextField');
      var id = $('#fetchHidden').attr('value');
      // var id = $(this).attr('value');
      // alert(id);

      var novoPlaceholderTextField = inputPlaceholderTextField.value;
      var novoLabelTextField = inputLabelTextField.value;
      var novoNameTextField = inputNameTextField.value;
      var novoWidthTextField = inputWidthTextField.value;
      var novoIdTextField = inputIdTextField.value;
      var novoDivTextField = inputDivTextField.value;

      $('.textfield'+id).attr('placeholder',novoPlaceholderTextField);
      $('.textfield'+id).attr('name',novoNameTextField);
      $('.textfield'+id).attr('id',novoIdTextField);
      $('#divTextField'+id).attr('class',novoDivTextField);
      // $('.editTextField').attr('value', novoIdTextField);
      // $("#mainTable").css("width", "100");
      $('.textfield'+id).css("width",novoWidthTextField);
      document.getElementById('labelTextField'+id).innerHTML = novoLabelTextField;

    });

$(document).ready(function() {
    var forma = $('#forma');
    var i = $('#forma').length;
    
   $(document).on('click', '#addPassword', function(){
            $('<div class="col-12" style="padding: 10px;" id = divPassword' + i +'><a style="font-weight: bold;">Password: </a><input type="password" style="height: 30px; width:270px" id="password' + i +'" name="password" value="" placeholder="Digite seu password" /> <button id="removePassword" class="teste btn btn-danger btn-sm" value="' + i + '"><i class="fa fa-close"></button></div>').appendTo(forma);
            i++;
            return false;
    });
    
   $(document).on('click', '#removePassword', function(){
            if( i > 0 ) {
                var id = $(this).attr('value');
                $('#divPassword'+id).fadeOut(300, function(){ 
                    $(this).remove();
                });
            }
            return false;
    });
});

$(document).ready(function() {
    var forma = $('#forma');
    var i = $('#forma').length;
    
   $(document).on('click', '#addSubmit', function(){
        if (i<2) {
            $('<div class="col-4" style="padding: 10px;" id = divSubmit'+i+'><button class="btn btn-success" type="submit" id="submit" style="width: 120px;">Submit</button> <button id="removeSubmit" class="teste btn btn-danger btn-sm" value="' + i + '"><i class="fa fa-close"></button></div>').appendTo(forma);
            i++;
            return false;
        }    
    });
    
   $(document).on('click', '#removeSubmit', function(){
                var id = $(this).attr('value');
                $('#divSubmit'+id).fadeOut(300, function(){ 
                    $(this).remove();
                });
                i--;
            return false;
    });
});

$(document).ready(function() {
    var forma = $('#forma');
    var i = $('#forma').length;
    
   $(document).on('click', '#addReset', function(){
        console.log(i);
        if (i<2) {
            $('<div class="col-4" style="padding: 10px;" id = divReset'+i+'><button class="btn btn-warning" type="reset" id="reset" style="width: 120px;">Reset</button> <button id="removeReset" class="teste btn btn-danger btn-sm" value="' + i + '"><i class="fa fa-close"></button></div>').appendTo(forma);
            i++;
            return false;
        }
    });
    
   $(document).on('click', '#removeReset', function(){
                var id = $(this).attr('value');
                $('#divReset'+id).fadeOut(300, function(){ 
                    $(this).remove();
                });
                i--;
            return false;
    });
});

$(document).ready(function() {

  var forma = $('#forma');
  var k = $('#forma').length;
  var j = $('.inputsCheckbox').length + 1;
  var divCheckbox = $('#divCheckbox');


 $(document).on('click', '#addCheckbox', function(){

    $('<div class="col-md-4 col-12" style="padding: 10px;" id = divCheckbox' + k +'><a style="font-weight: bold;">Checkbox:</a> <button id="removeCheckbox" class="teste btn btn-danger btn-sm" value="' + k + '"> <i class="fa fa-close"></i></button> <button id="addCheckboxInput'+ k +'" class="teste addCheckboxInput btn btn-primary btn-sm" value="'+ k +'"> <i class="fa fa-plus"></i></button> <button id="removeCheckboxInput'+ k +'" class="teste removeCheckboxInput btn btn-warning btn-sm" value=""> <i class="fa fa-minus"></i></button> <br> <div class = "inputsCheckbox'+ k +'" id = "inputsCheckbox' + k +'"></div></div>').appendTo(forma);
    k++;
    return false;
  });

  $(document).on('click', '.addCheckboxInput', function(){
    var idCheckbox = $(this).attr('value');
    var qtde = $('.checkbox'+idCheckbox).length + 1;
    $('<input type="checkbox" id="checkbox' + qtde +'" size="20" name="checkbox" class="checkbox'+idCheckbox+'" value="' + qtde +'" /> <a class="option'+idCheckbox+'" style="font-weight: bold;">Option ' + qtde +'<br></a>').appendTo(".inputsCheckbox"+idCheckbox);
    //$(".inputsCheckbox"+i).append('teste');
     //<input type=\"checkbox\" id=\"checkbox' + i +'\" size=\"20\" name=\"checkbox\" value=\"\" />
    $('#removeCheckboxInput'+idCheckbox).attr('value',idCheckbox);

    return false;
  });

  $(document).on('click', '.removeCheckboxInput', function(){
    var idCheckbox = $(this).attr('value');
    var qtde = $('.checkbox'+idCheckbox).length;
    $('.checkbox'+idCheckbox).last().remove();
    $('.option'+idCheckbox).last().remove();
    return false;
  });
        
  $(document).on('click', '#removeCheckbox', function(){
    if( k > 0 ) {
        //$(this).parent().remove();
        //i--;
        var id = $(this).attr('value');
        $('#divCheckbox'+id).fadeOut(300, function(){ 
            $(this).remove();
        });
   }
    return false;
  });    

});



$(document).ready(function() {

    var forma = $('#forma');
    var k = $('#forma').length;
    var j = $('.inputsRadio').length + 1;
    var divRadio = $('#divRadio');
    var teste;  


   $(document).on('click', '#addRadio', function(){
             $('<div class="col-md-4 col-12" style="padding-top: 10px; padding-left: 10px;" id = divRadio' + k +'><a style="font-weight: bold;">Radio: <button id="removeRadio" class="teste btn btn-danger btn-sm" value="' + k + '"> <i class="fa fa-close"></i></button> <button id="addRadioOption" class="teste btn btn-primary btn-sm" value="' + k + '"> <i class="fa fa-plus"></i></button> <br> <form action ="" class = "inputsRadio'+ k +'" id = "inputsRadio' + k +'"></div></div></a>').appendTo(forma);
            k++;
            return false;
    });

    $(document).on('click', '#addRadioOption', function(){
                var idRadio = $(this).attr('value'); 
                $('<input type="radio" id="radio' + j +'" size="20" name="radio" value=""/> Escolha<br>').appendTo(".inputsRadio"+idRadio);
                //$(".inputsRadio"+i).append('teste');
                 //<input type=\"Radio\" id=\"Radio' + i +'\" size=\"20\" name=\"Radio\" value=\"\" />
                 j++;
                return false;
            });
        
   $(document).on('click', '#removeRadio', function(){
            if( k > 0 ) {
                //$(this).parent().remove();
                //i--;
                var id = $(this).attr('value');
                $('#divRadio'+id).fadeOut(300, function(){ 
                    $(this).remove();
                });
           }
            return false;
    });    

});
    
</script>

    </body>
</html>
